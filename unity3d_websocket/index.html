<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>- websocket - - Evan's Dev Note</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "- websocket -";
    var mkdocs_page_input_path = "unity3d_websocket.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-36723568-3', 'mkdocs.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Evan's Dev Note</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../nodejs/">현재 편집중...</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">프로젝트 1 CHAT</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../_chat/">- chat -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">프로젝트 2 MMO</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../_mmo/">- mmo -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">HTML</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../html/">- html -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../css/">- css -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">자바스크립트</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../javascript/">- javascript -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../typescript/">- typescript -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">노드.JS</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../nodejs/">- node.js -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../express/">- express -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">플러터</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../flutter/">- flutter -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">WEBGL</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../threejs/">- three.js -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../blueprint3d/">- blueprint3d.js -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">파이썬</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../python/">- python -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">씨#</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../csharp/">- c# -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">유니티3D</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../unity3d/">- unity3d -</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">- websocket -</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#websocket-sharp">websocket-sharp</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#websockets-in-net-45">WebSockets in .NET 4.5</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">인공지능</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../chatbot/">- chatbot -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">인프라</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../aws/">- aws -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../azure/">- azure -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../linux/">- linux -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../docker/">- docker -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../kubernetes/">- kubernetes -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">알고리즘</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../crypto/">- cryptography -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">툴</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../mkdocs/">- mkdocs -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../jekyll/">- jekyll -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../git/">- git -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../chocolatey/">- chocolatey -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../vscode/">- vscode -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../blender/">- blender -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">빌드 툴</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../webpack/">- webpack -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../grunt/">- grunt -</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">ETC</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../tools/">- 기타툴</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../errors/">- 각종에러 -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../terms/">- 용어들 -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../benchmark/">- 벤치마크 -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../shortcuts/">- 단축키 -</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sites/">- 참고사이트 -</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/">ABOUT</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Evan's Dev Note</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>유니티3D &raquo;</li>
        
      
    
    <li>- websocket -</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="unity3d-websocket">Unity3D Websocket</h1>
<h2 id="websocket-sharp">websocket-sharp</h2>
<ul>
<li>유니티 엔진에서 웹소켓을 사용 가능하게 해 준다.</li>
</ul>
<p>설치</p>
<ul>
<li><a href="https://github.com/sta/websocket-sharp">Github-websocket-sharp</a> 에서 전체프로젝트 또는 dll만 다운로드</li>
<li><code>websocket-sharp.dll</code>을 <code>Assets/Plugins</code>폴더에 복사</li>
</ul>
<hr />
<h2 id="websockets-in-net-45">WebSockets in .NET 4.5</h2>
<ul>
<li>닷넷 표준 웹소켓 .NET4.5 이상에서 사용 가능</li>
</ul>
<p>설치</p>
<ul>
<li><a href="https://docs.microsoft.com/ko-kr/dotnet/api/system.net.websockets.websocket?view=net-5.0">WebSocket .NET</a></li>
</ul>
<hr />
<p>참고</p>
<ul>
<li><a href="https://timeboxstory.tistory.com/69">https://timeboxstory.tistory.com/69</a></li>
<li><a href="https://www.codeproject.com/articles/733297/websocket-libraries-comparison">웹소켓 라이브러리 비교</a></li>
<li><a href="https://github.com/statianzo/Fleck">웹소켓 서버 라이브러리 Fleck</a></li>
<li><a href="https://github.com/nhn/socket.io-client-unity3">웹소켓 클라이언트 NHN에서 개발</a> - Socket.IO v2 is not supported</li>
<li><a href="https://devstarsj.github.io/development/2016/05/12/CSharp.AspnetCore.WebSocket/">WebSockets in .NET Core</a></li>
<li><a href="https://www.youtube.com/watch?v=Zjm5KGHyceU&amp;feature=youtu.be">How to Install Node.js on Mac OS and Run Live Stream in 2 minutes</a></li>
</ul>
<hr />
<!--
출처: <http://www.gamecodi.com/board/zboard-id-GAMECODI_Talkdev-no-3234-z-8.htm>

모바일 게임이고

실시간 멀티플레이가 가능한 게임 서버를 만들려고 합니다. (클라는 유니티로)

웹서버로 하고 웹소켓을 고려중인데

그냥 TCP 소켓을 쓰는 방식에 비해 어떤 장단점이 있을까요?

추측입니다만 웹으로 가면 안정성과 개발편의성 등등이 있을것 같은데요.

어떻게들 보시나요?

저희 프로젝트가 WebSocket을 사용했었습니다.
실시간 PvP를 위해 사용되었습니다.
저희 서버쪽이 웹서버 베이스이기도하고,, 실시간 게임서버 개발에 대한경험이 딱히 없었기 때문에 사용했습니다.

구성은 아래와 같고,,
서버: NodeJS/SocketIO,
클라: Unity3D + WebSocket/SocketIO 지원 Http 클라이언트(UniWeb)

장점은,,
프로토콜이 무척 간단하고 쉽기 때문에, 오롯히 비지니스로직에만 집중할 수 있습니다.
리얼에 운영된 실시간 PvP의 서버코드가 1000라인 내외일정도니깐,, 개발속도만큼은 확실히 이득입니다.
클라도 에셋스토어에서 소켓IO지원 Http 모듈만 잘 구하면,, 오롯히 비지니스에만 집중가능합니다.
통신은 암호화된 Json으로 했습니다.

몇가지 이슈가 있었는데
클라:

- UniWeb SocketIO 가 구버전 프로토콜만을 지원
- 프로토콜 지원이 완벽하지 않아서(heartbeat 가 안보내지는 이슈..) Uniweb을 수정후 사용했습니다.
- 저희가 개발을 시작할 당시에 SocketIO를 지원하는 Unity 플러그인이 이거 밖에 없었는데,, 지금은 BEST HTTP도 있는것 같습니다.

서버:

- NodeJS문제인지 SocketIO문제인지,, 메모리가 지속적으로 누수되는 문제가 있습니다.
- 구글링 결과 SocketIO이슈인것 같긴한데,, 클라가 SocketIO 구버전 프로토콜만을 지원해서,, 버전업이 불가했습니다.
- 가비지 컬렉션으로 갑자기 순단이 발생합니다. 실시간 PvP 에서 순단이 무척 민감해서, 가비지 컬렉션 옵션을 이래저래 많이 신경써야 합니다.
- 하지만 아무리 신경써도 순단을 완벽히 막진 못합니다.

저희 게임이 흥행에 실패해서ㅠㅠ
사용자가 많진 않았지만,, 피크일때도 응답속도는 괜찮았습니다.
다만 메모리 누수때문에 지속적으로 서버 재붓을 해줘야 했던게...
메모리 누수 때문에 Java기반의 Vert.x 도 고려해봤는데,, 시간이 부족해서 이사는 못했네요.

출처: https://202psj.tistory.com/1347 [알레폰드의 IT 이모저모]

---

유니티 클라이언트와
Node.js 를 웹소켓 연결해서 썼었습니다.
서비스도 몇달동안 했었구요. 중국과 일본에서 접속자들이 꽤 있었는데
실시간 게임인데도 접속이나 전송관련해서 버그리포팅들어온건 따로 없었습니다.

웹소켓이 다른걸 떠나서 제일 큰 장점이라면
웹브라우져에서 돌아가는 서버 테스트용 더미 클라이언트를
바로바로 수정할수 있어서 신속하게 만들수가 있다는 거죠.

그래서 서버 스트레스 테스트 라던가 프로토콜 테스트할때 필요한
여러가지 시나리오를 죄다 만들어 놓고
테스트 유닛을 자동화 시켰었습니다.

시간은 그렇게 오래 걸리지 않았습니다.

다음 프로젝트 때도 웹소켓을 쓰겠냐고 묻는다면
별다른 문제가 생기지 않는한 쓸겁니다. -->
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../chatbot/" class="btn btn-neutral float-right" title="- chatbot -">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../unity3d/" class="btn btn-neutral" title="- unity3d -"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../unity3d/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../chatbot/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
