<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>- NodeJS - Evan's IT Note</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "- NodeJS";
    var mkdocs_page_input_path = "nodejs.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-36723568-3', 'mkdocs.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Evan's IT Note</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">PROJECT 1 CHAT</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../_chat/">- Chat</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">PROJECT 2 MMO</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../_mmo/">- MMO</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">HTML</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../html/">- HTML</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../css/">- CSS</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">TYPESCRIPT</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../typescript/">- Typescript</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">NODE.JS</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">- NodeJS</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#11">1.1. 개요</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#12">1.2. 설정</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#121">1.2.1. 설치</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#122-npm">1.2.2. npm 사용법</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#123">1.2.3. 새 프로젝트 생성</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#124-express-socketio">1.2.4. express, socket.io 프로젝트 생성</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#13">1.3. 주요 내장 모듈</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#131-console">1.3.1. console 내장 (콘솔)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#132-process">1.3.2. process 내장 (실행환경)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#133-exports">1.3.3. exports 내장 (라이브러리)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#134-os">1.3.4. os (시스템 호출)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#135-url-url-paring">1.3.5. url (url paring)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#136-util">1.3.6. util (유틸)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#137-crypo">1.3.7. crypo (암호화)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#138-fs">1.3.8. fs (파일)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#139-http">1.3.9. http (웹서버)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#14">1.4. 주요 외부 모듈</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#141-ejs">1.4.1. ejs (뷰템플릿 엔진)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#142-jade">1.4.2. jade (뷰템플릿 엔진)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#143-socketio">1.4.3. socket.io (실시간 웹통신)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#144-express">1.4.4. express (웹서버 프레임웍)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#145-cluster">1.4.5. cluster (코어 하나당 노드 프로세스를 실행한다)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#15">1.5. 툴</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#151-pm2">1.5.1. pm2 (프로세스 매니저)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#152-supervisor">1.5.2. supervisor (서버 자동 갱신, 잘 안씀)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#153-forever">1.5.3. forever (잘 안씀)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#16">1.6. 활용</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#161">1.6.1. 예외 처리</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#162">1.6.2. 이벤트</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#17">1.7. 참고</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">PYTHON</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../python/">- Python</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">C#</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../csharp/">- C#</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">UNITY3D</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../unity3d/">- Unity3D</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../unity3d_websocket/">- Websocket</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">AI</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../chatbot/">- Chatbot</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">INFRA</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../aws/">- AWS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../azure/">- Azure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../linux/">- Linux</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../crypto/">- RSA-AES-SHA</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../docker/">- Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../kubernetes/">- Kubernetes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">TOOLS-DEV</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../mkdocs/">- Mkdocs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../jekyll/">- Jekyll</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../git/">- Git</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../chocolatey/">- Chocolatey</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../vscode/">- VSCode</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">TOOLS-ETC</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../blender/">- Blender</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">ETC</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../terms/">- 용어들</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../benchmark/">- 벤치 마크</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sites/">- 참고 사이트</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../shortcuts/">- 참고 단축키</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../etc/">- 기타</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/">ABOUT</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Evan's IT Note</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>NODE.JS &raquo;</li>
        
      
    
    <li>- NodeJS</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="1-nodejs">1. Node.js</h1>
<h2 id="11">1.1. 개요</h2>
<blockquote>
<p>Node.js는 확장성 있는 네트워크 애플리케이션 개발에 사용되는 소프트웨어 플랫폼이다. 작성 언어로 자바스크립트를 활용하며 Non-blocking I/O와 단일 스레드 이벤트 루프를 통한 높은 처리 성능을 가지고 있다. - 위키백과</p>
</blockquote>
<hr />
<h2 id="12">1.2. 설정</h2>
<h3 id="121">1.2.1. 설치</h3>
<ul>
<li>Windows:<br />
  직접 다운로드 또는 choco로 설치<br />
<code>choco install nodejs -y</code></li>
</ul>
<h3 id="122-npm">1.2.2. npm 사용법</h3>
<ul>
<li>글로벌로 설치<br />
<code>npm install xxx -g</code></li>
<li>현재 폴더에 설치<br />
<code>npm install xxx</code></li>
<li>현재 폴더에 설치 하고 package.json에 추가
  <code>npm install xxx --save</code></li>
<li>글로벌에서 설치 삭제<br />
<code>npm uninstall xxx -g</code></li>
<li>글로벌 설치 목록 조회<br />
<code>npm list -g</code></li>
<li>package.json 에 명령어 등록해서 프로젝트 실행
  <code>npm start</code> 또는 <code>npm test</code><br />
<code>npm run-script kill</code><br />
<code>npm run-script reload</code></li>
</ul>
<pre><code class="language-json">//package.json 예시
...
&quot;scripts&quot;: {
  &quot;start&quot;: &quot;pm2 start app.js -i 0&quot;,
  &quot;test&quot;: &quot;pm2 start app.js --watch&quot;,
  &quot;kill&quot;: &quot;pm2 kill&quot;,
  &quot;reload&quot;: &quot;pm2 reload all&quot;
},
...
</code></pre>
<h3 id="123">1.2.3. 새 프로젝트 생성</h3>
<ul>
<li>프로젝트명 빈 폴더 생성<br />
<code>mkdir [프로젝트폴더]</code><br />
<code>cd [프로젝트폴더]</code></li>
<li>프로젝트 초기화<br />
<code>npm init</code></li>
<li>디펜던시 편집<br />
<code>package.json</code></li>
<li>라이브러리 설치<br />
<code>npm install</code></li>
<li>특정 라이브러리 설치 (+ package.json에 추가)
  <code>npm install [라이브러리이름] --save</code></li>
</ul>
<h3 id="124-express-socketio">1.2.4. express, socket.io 프로젝트 생성</h3>
<ul>
<li>가이드: <a href="https://expressjs.com/ko/starter/installing.html">https://expressjs.com/ko/starter/installing.html</a><br />
<code>mkdir [프로젝트폴더]</code><br />
<code>cd [프로젝트폴더]</code><br />
<code>npm init</code><br />
<code>npm install socket.io --save</code><br />
<code>npm install express --save</code></li>
</ul>
<hr />
<h2 id="13">1.3. 주요 내장 모듈</h2>
<h3 id="131-console">1.3.1. console 내장 (콘솔)</h3>
<pre><code class="language-javascript">console.log(&quot;hello&quot;);
</code></pre>
<h3 id="132-process">1.3.2. process 내장 (실행환경)</h3>
<pre><code class="language-javascript">process.argv; //실행 변수
process.env; //환경변수
process.version; //Node.js버전
process.platform; //플랫폼
process.exit(0); //종료
process.memoryUsage(); //메모리 사용량
process.uptime(); //현재 프로그램이 실행된 시간
</code></pre>
<h3 id="133-exports">1.3.3. exports 내장 (라이브러리)</h3>
<blockquote>
<p>모듈 (라이브러리) 내보내기 가져오기</p>
</blockquote>
<pre><code class="language-javascript">// 모듈 쪽
// xxx.js 또는 xxx/index.js 의 내용
exports.foo = function () {};
</code></pre>
<pre><code class="language-javascript">// 사용하는 쪽
let module = require(&quot;./xxx&quot;);
module.foo();
</code></pre>
<h3 id="134-os">1.3.4. os (시스템 호출)</h3>
<pre><code class="language-javascript">var os = require(&quot;os&quot;);
os.hostname(); //호스트 이름
os.type(); //운영체제 이름
os.platform(); //운영체제 플랫폼?
os.arch(); //운영체제 아키텍쳐?
os.release(); //운영체제 버전
os.uptime(); //운영체제가 실행된 시간
os.laodavg();
os.totalmem(); //총 메모리
os.freemem(); //가용 메모리
os.cpus(); //CPU
os.networkInterfaces(); //네트웍인터페이스
</code></pre>
<h3 id="135-url-url-paring">1.3.5. url (url paring)</h3>
<pre><code class="language-javascript">var url = require(&quot;url&quot;);
url.parse(); //url 문자열을 url 객체로 변환리턴
url.format(); //url객체를 url문자열로 변환
url.resolve(from, to); //조합해서 URL 문자열 생성
</code></pre>
<h3 id="136-util">1.3.6. util (유틸)</h3>
<pre><code class="language-javascript">var util = require(&quot;util&quot;);
util.format(,...); //문자열 조합
</code></pre>
<h3 id="137-crypo">1.3.7. crypo (암호화)</h3>
<blockquote>
<p>해시 생성과 암호화 기능</p>
</blockquote>
<ul>
<li>해시 (복호화 불가)</li>
</ul>
<pre><code class="language-javascript">// 해시 생성과 암호화를 수행하는 모듈
var crypo = require(&quot;crypo&quot;);
// 해시 생성
var shasum = crypo.createHash(&quot;sha256&quot;);
shasum.update(&quot;crypo_hash&quot;);
var output = shasum.digest(&quot;hex&quot;);
//출력
console.log(&quot;crypto_hash:&quot;, output);
</code></pre>
<ul>
<li>대칭키 암호화 (AES)</li>
</ul>
<pre><code class="language-javascript">var crypo = require(&quot;crypo&quot;);
var key = &quot;mykey&quot;;
var input = &quot;PASSWORD&quot;;

//암호화
var cipher = crypto.createCipher(&quot;aes192&quot;, key);
ciper.update(input, &quot;utf8&quot;, &quot;base64&quot;);
var cipheredOutput = cipher.final(&quot;base64&quot;);

//복호화
var decipher = crypto.createDecipher(&quot;aes192&quot;, key);
decipher.update(cipheredOutput, &quot;base64&quot;, &quot;utf8&quot;);
var decipheredOutput = decipher.final(&quot;utf8&quot;);
</code></pre>
<h3 id="138-fs">1.3.8. fs (파일)</h3>
<pre><code class="language-javascript">// 읽기
var fs = require(&quot;fs&quot;);

// 즉시 읽기
var text = fs.readFile(&quot;textfile.txt&quot;, &quot;utf8&quot;);
console.log(text);

// 읽기
fs.readFile('textfile.txt', 'utf8' function(error,data){
  console.log(data);
});
</code></pre>
<pre><code class="language-javascript">// 쓰기
var fs = require(&quot;fs&quot;);

// 쓰기
var data = &quot;Hello World&quot;;
fs.writeFile(&quot;TextFileOtherWrite.txt&quot;, data, &quot;utf8&quot;, function (error) {
  console.log(&quot;Write File Asysnc Complete&quot;);
});

// 즉시 쓰기
fs.writeFileSync(&quot;TextFileOtherWriteSync.txt&quot;, data, &quot;utf8&quot;);
console.log(&quot;Write File Sysnc Complete&quot;);
</code></pre>
<ul>
<li>비동기 함수는 에러 코드로 예외처리 한다.</li>
</ul>
<pre><code class="language-javascript">var fs = require(&quot;fs&quot;);

// 파일을 읽습니다
fs.readFileSync(&quot;textfile.txt&quot;, &quot;utf8&quot;, function (error, data) {
  if (error) {
    console.log(error);
  } else {
    console.log(&quot;File read complete:&quot;, data);
  }
});

fs.writeFile(&quot;textfile.txt&quot;, &quot;Hello World&quot;, &quot;utf8&quot;, function (error) {
  if (error) {
    console.log(error);
  } else {
    console.log(&quot;File write complete&quot;);
  }
});
</code></pre>
<h3 id="139-http">1.3.9. http (웹서버)</h3>
<pre><code class="language-javascript">var fs = require(&quot;fs&quot;);
var http = require(&quot;http&quot;);
http
  .createServer(function (request, response) {
    var date = new Date();

    //파일 읽어들임
    fs.readFile(&quot;index.html&quot;, function (error, data) {
      response.writeHead(200, {
        &quot;content-type&quot;: &quot;text/html&quot;, //mime 타입
        &quot;set-cookie&quot;: [&quot;name = aaa&quot;, &quot;date = &quot; + date.toUTCString()], //쿠키 설정
      });

      //출력
      response.write(&quot;: current cookie is &quot; + request.headers.cookie);
      response.end(data);
    });
  })
  .listen(80, function () {
    console.log(&quot;server running&quot;);
  });
</code></pre>
<ul>
<li>리다이렉션</li>
</ul>
<pre><code class="language-javascript">response.writeHead(302, { Location: &quot;http://www.naver.com&quot; });
</code></pre>
<hr />
<h2 id="14">1.4. 주요 외부 모듈</h2>
<h3 id="141-ejs">1.4.1. ejs (뷰템플릿 엔진)</h3>
<blockquote>
<p>View Template Engine
Jave의 Thymeleaf 같은 역할</p>
</blockquote>
<ul>
<li>설치<br />
<code>npm install ejs</code></li>
</ul>
<h3 id="142-jade">1.4.2. jade (뷰템플릿 엔진)</h3>
<blockquote>
<p>View Template Engine
pug 로 이름 바뀜? //todo! 확인필요</p>
</blockquote>
<ul>
<li>설치<br />
<code>npm install jade</code></li>
</ul>
<h3 id="143-socketio">1.4.3. socket.io (실시간 웹통신)</h3>
<blockquote>
<p>Socket.io 는 브라우저에서 웹소켓을 지원하던, 지원하지 않던 관계없이 실시간 웹통신을 가능하게 에뮬레이션 해 주는 nodejs 라이브러리이다. (즉 Socket.io를 사용하면 개발할 때 웹소켓을 직접 사용할 필요가 없다는 뜻)</p>
</blockquote>
<h3 id="144-express">1.4.4. express (웹서버 프레임웍)</h3>
<blockquote>
<p>Express.js, 또는 간단히 익스프레스는 Node.js를 위한 웹 프레임워크의 하나로, MIT 허가서로 라이선스되는 자유-오픈 소스 소프트웨어로 출시되었다. 웹 애플리케이션, API 개발을 위해 설계되었다. Node.js의 사실상의 표준 서버 프레임워크로 불리고 있다. - 위키백과</p>
</blockquote>
<ul>
<li>express는 자바 스프링 같이 프레임웍이라고 생각하면 된다. 기본 http 모듈은 서블릿 같은 기본 기능이라고 보면 된다.</li>
</ul>
<pre><code class="language-javascript">const express = require(&quot;express&quot;);
const app = express();
const port = 3000;
//method get, path /
app.get(&quot;/&quot;, function (req, res) {
  res.send(&quot;Hello World!&quot;);
});
app.listen(port, function () {
  console.log(`application is listening on port ${port}...`);
});
</code></pre>
<h3 id="145-cluster">1.4.5. cluster (코어 하나당 노드 프로세스를 실행한다)</h3>
<pre><code class="language-javascript">const numCPUs = require(&quot;os&quot;).cpus().length; //코어개수 확인
const cluster = require(&quot;cluster&quot;);
const http = require(&quot;http&quot;);

if (cluster.isMaster) {
  console.log(`master: ${process.pid}`);

  // CPU 개수마큼 워커를 생산
  for (let i = 0; i &lt; numCPUs; i++) {
    cluster.fork();
  }

  // 워커가 종료되었을 때
  cluster.on(&quot;exit&quot;, (worker, code, singal) =&gt; {
    console.log(`${worker.process.pid}: closed!`);
    // 프로세스 다시 살린다
    cluster.fork();
  });
} else {
  // 워커들이 포트에서 대기
  http
    .createServer((req, res) =&gt; {
      res.end(`Hi, I'm cluster`);
    })
    .listen(8005);
  console.log(&quot;worker: &quot;, process.pid);
}
</code></pre>
<p>참고: <a href="https://mongojs.tistory.com/15">https://mongojs.tistory.com/15</a></p>
<hr />
<h2 id="15">1.5. 툴</h2>
<h3 id="151-pm2">1.5.1. pm2 (프로세스 매니저)</h3>
<ul>
<li>설치<br />
<code>npm install pm2 -g</code><br />
<code>pm2 -version</code></li>
<li>실행 (실행즉시 daemon화 되어, 에러가 나지 않는 이상 24시간 계속 유지됨)<br />
<code>pm2 start example.js</code></li>
<li>실행 옵션<br />
  --watch : PM2가 프로젝트의 변경사항을 감지하여 서버를 자동 리로드 (개발 단계에서 편리)<br />
<code>pm2 start example.js --watch</code><br />
  -i max(코어개수) : Node.js의 싱글 스레드를 보완하기 위한 클러스터(Cluster) 모드<br />
  -i 뒤에 코어의 개수를 입력하거나 max를 쓰면 최대 코어 개수로 클러스터링(Clustering) 된다<br />
<code>pm2 start example.js --watch -i max</code></li>
<li>종료<br />
<code>pm2 kill</code></li>
<li>실행 프로세스 목록 조회<br />
<code>pm2 list</code></li>
<li>모니터링<br />
<code>pm2 monit</code></li>
<li>다시 로드
  <code>pm2 reload all</code></li>
</ul>
<p>참고: <a href="https://engineering.linecorp.com/ko/blog/pm2-nodejs/">https://engineering.linecorp.com/ko/blog/pm2-nodejs/</a></p>
<blockquote>
<p>pm2 레퍼런스: <a href="https://www.npmjs.com/package/pm2">https://www.npmjs.com/package/pm2</a></p>
</blockquote>
<!-- https://github.com/NodeRedis/node-redis -->

<h3 id="152-supervisor">1.5.2. supervisor (서버 자동 갱신, 잘 안씀)</h3>
<blockquote>
<p>파일의 변경 사항을 인식하고 노드를 재 실행 시켜줌</p>
</blockquote>
<ul>
<li>설치:<br />
<code>npm install -g supervisor</code></li>
<li>사용법: node 대신 supervisor를 사용해 실행한다<br />
<code>node myapp.js</code> =&gt; <code>supervisor myapp.js</code></li>
<li>윈도우에서 실행할 권한이 없다고 뜨면 파워셀을 관리자 권한으로 실행 후 아래 입력한다<br />
<code>set-executionpolicy unrestricted</code></li>
</ul>
<h3 id="153-forever">1.5.3. forever (잘 안씀)</h3>
<ul>
<li>설치:<br />
<code>npm install -g forever</code></li>
</ul>
<hr />
<h2 id="16">1.6. 활용</h2>
<h3 id="161">1.6.1. 예외 처리</h3>
<ul>
<li>동기(즉시) 함수는 try catch로 예외처리 한다.</li>
</ul>
<pre><code class="language-javascript">var fs = require(&quot;fs&quot;);

// 파일을 읽습니다
try {
  var data = fs.readFileSync(&quot;textfile.txt&quot;, &quot;utf8&quot;);
  console.log(data);
} catch (e) {
  console.log(e);
}

// 파일을 씁니다
try {
  fs.writeFileSync(&quot;textfile.txt&quot;, &quot;Hello World&quot;, &quot;utf8&quot;);
  console.log(&quot;file write complete&quot;);
} catch (e) {
  console.log(e);
}
</code></pre>
<h3 id="162">1.6.2. 이벤트</h3>
<ul>
<li>이벤트 핸들러</li>
</ul>
<pre><code class="language-javascript">// 종료 이벤트 처리
process.setMaxListeners(15); //최대 리스너 개수 지정 가능
process.on(&quot;exit&quot;, function () {
  //리스너 등록
  console.log(&quot;앱종료됨&quot;);
});
process.once(&quot;exit&quot;, function () {
  //1회성 리스너 등록
  console.log(&quot;앱종료됨&quot;);
});

// 처리되지 않은 예외 이벤트 처리
process.on(&quot;uncaughtException&quot;, onUncaughtException); //리스너 등록
process.removeListener(&quot;exit&quot;, onUncaughtException); //리스너 제거
process.removeAllListener(&quot;exit&quot;); //리스너 모두 제거
</code></pre>
<ul>
<li>이벤트 강제 발생</li>
</ul>
<pre><code class="language-javascript">process.emit(&quot;exit&quot;); //이벤트 핸들러만 호출하지 실제 시스템이 종료되지는 않는다
</code></pre>
<ul>
<li>EventEmitter 모듈 밖으로 내보내기</li>
</ul>
<pre><code class="language-javascript">//rint.js
exports.timer = new process.EventEmitter();
setInterval(function () {
  exports.timer.emit(&quot;tick&quot;);
}, 1000);
</code></pre>
<pre><code class="language-javascript">//app.js
var rint = require(&quot;./rint&quot;);
rint.timer.on(&quot;tick&quot;, function (code) {
  console.log(&quot;이벤트를 실행합니다.&quot;);
});
</code></pre>
<hr />
<h2 id="17">1.7. 참고</h2>
<ol>
<li><a href="https://nodejs.org/dist/latest-v14.x/docs/api/">Node.js v14.15.3 Documentation 공식 API 문서</a></li>
<li>[Node.js] Socket.IO와 Redis를 활용한 채팅 서버 개발: <a href="https://library.gabia.com/contents/infrahosting/8018/">https://library.gabia.com/contents/infrahosting/8018/</a></li>
<li>Nodejs Native module</li>
</ol>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../python/" class="btn btn-neutral float-right" title="- Python">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../typescript/" class="btn btn-neutral" title="- Typescript"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../typescript/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../python/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
